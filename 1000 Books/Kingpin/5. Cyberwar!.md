# 5. Cyberwar!

- Performed haphazardly, such an attack would cause the program to crash. But a careful hacker could do much worse. He could load the buffer with his own small snippet of executable computer code, then he could keep going, tripping cautiously all the way to the top of the program’s memory space, where a special short-term storage area called the “stack” resides.
- The stack is where the computer’s processor keeps track of what it’s doing - every time a program diverts the computer off to a subroutine, the processor pushes its current memory address onto the stack, like a bookmark, so it knows where to return to when it’s done.
- Once a hacker is in the stack, he can overwrite the last return address with the location of his own malicious payload. When the computer is done with the current subroutine, it returns not to where it began, but to the hacker’s instruction - and because BIND runs under the all-powerful administrative “root” account, the attacker’s code does as well. The computer is now under the hacker’s control.

-  The government-funded Computer Emergency Response Team at Carnegie Mellon University - which runs a kind of Emergency Broadcast System for security holes - issued an alert about the BIND flaw, along with a link to the simple fix: two additional lines of computer code that rejected overlong queries. But CERT packaged its alert with two other BIND vulnerabilities that were of little consequence and understated the importance of the hole. ***Consequently, not everyone appreciated the gravity of the situation. Max understood perfectly.***

- He read the CERT advisory with amazement. BIND came installed standard with Linux, and it ran on servers on corporate, ISP, nonprofit, educational, and military networks. It was everywhere. And so was the defective line of code. The only thing holding back a feeding frenzy of attacks was that nobody had written a program to exploit the security hole. But that was just a matter of time.

- Sure enough, on May 18, an exploit program showed up on Rootshell.com, a computer security news site run by hobbyists. Max picked up the phone and called his FBI contact, Chris Beeson, at home. The situation was serious, he explained. Anybody who hadn’t installed the BIND patch could now be hacked by any script kiddy capable of downloading a program and typing a command.

- If history was a guide, government computers would be particularly vulnerable. Just a month earlier, a less serious bug in the Sun Solaris operating system had led to a hacker cracking computers at a dozen U.S. military bases, in what a deputy defense secretary called “the most organized and systematic attack to date” on American defense systems. Those attacks had set off a full-blown cyberwarfare false alarm: The Pentagon gave the intrusions the code name “Solar Sunrise” and considered Saddam Hussein the prime suspect until investigators traced the attacks to a young Israeli hacker who was just playing around.

- Max called Beeson again the next day, when a hacker group named ADM released a weaponized version of the BIND exploit designed to scan the Internet at random looking for unpatched servers, then break in, install itself, and use the newly compromised computer as a platform for still more scans and break-ins. It was a certainty now that someone was going to own the entire Internet. ***It was just a question of who.***
- He hung up and pondered. ***Someone was going to do it....***

- He shared his plans with his new wife in boyish, excited tones. Max would author his own BIND attack. His version would close the hole everywhere it found it, like releasing sterile fruit flies to tamp down an infestation. He would limit his attack to the targets most in need of an emergency security upgrade: U.S. military and civilian government sites.

- ***“Don’t get caught,”*** said Kimi, ***who’d learned not to argue with Max when he was like this, his mind hostage to an idea.***

- Max was struggling with the binary nature of his personality: the professional married man with a stake in the world around him, and the impulsive child tempted by every call to mischief. ***The child won. He sat at his keyboard and plunged into furious programming.***

- His code would operate in three rapid-fire stages. It would begin by flinging a virtual grappling hook through the BIND hole, executing commands that forced the machine to reach out over the Internet and import a 230-byte script. That script, in turn, would connect it to a different host infiltrated by Max, where it would download a hefty package of evil called a “rootkit.”

- A ***rootkit*** is a bundle of standard system programs that have been corrupted to secretly serve the hacker: A new login program operates just like the real thing but now includes a back door through which the intruder can reenter the machine. The “passwd” program still lets users change their passwords but also quietly records and stores the new password where it can be retrieved later. The new list program lists the contents of a directory, as it should, but takes care to conceal any files that are part of the rootkit.

- Once the rootkit was in place, Max’s code would accomplish what the government failed to do: It would upgrade the hacked computer to the latest version of BIND, closing the security hole through which it had entered. The computer would now be safe from any future attacks, but Max, the benevolent meddler, would still be able to reenter the system at will. Max was at once fixing the problem and exploiting it; he was a black hat and a white hat at the same time.

- The whole attack would take just a couple of minutes each time. One moment, the computer would be controlled by the system administrators; then, grappling hook, download script, rootkit, and it was in Max’s pocket.

- Max was still programming when the FBI got back to him and asked for a full report on the BIND hole. But the feds had had their chance; ***Max’s code would speak for him now.***

- The results were instant and highly satisfying. Max’s grappling-hook code was designed to signal its success to his computer over the Verio dial-up, so he could watch the attack spread. Hacked machines around the country reported back to him, an Xterm window popping up on his screen for each one. Brooks Air Force Base - now property of Max Vision. Mc-Chord, Tinker, Offutt, Scott, Maxwell, Kirtland, Keesler, Robins. His code wormed into Air Force servers, Army computers, a machine in the office of a cabinet secretary. Each machine now had a back door that Max could use any time he wanted.

- Max was notching up military conquests like points in a video game. When his code swept into the Navy’s Internet space, it found so many unpatched BIND servers that the stream of pop-ups turned into a torrent. His own computer struggled under the strain, then crashed.
- ***After some fine-tuning, he relaunched. For five days he was absorbed in his growing dominion over cyberspace.*** He ignored e-mail from the FBI, who still wanted that report.

- There had to be more he could do with the power to crack almost any network he wanted. Max trained his BIND exploit on the servers of Id Software in Mesquite, Texas, a gaming company developing a third installment of the enormously popular first-person shooter Quake. Max loved first-person shooters. He was on the network in a flash, and after some exploring, he emerged with his trophy. He announced to Kimi that he’d just obtained the source code - the virtual blueprints - for Quake III, the most anticipated game of the year.

- Max soon realized that his attacks were getting some attention. At Lawrence Berkeley National Laboratory, a researcher named Vern Paxson spotted Max’s scanning using a new system he’d developed called BRO, for Big Brother. BRO was an experiment in a relatively new kind of security countermeasure called an ***intrusion detection system - a cyber burglar alarm with the sole function of sitting quietly on a network and sifting through all the traffic for suspicious activity, alerting administrators when it spots something that doesn’t look right.***

- With that, Max shut down his five-day attack on the government, with more cracked systems behind him than he could count. He was satisfied that he’d made the Internet safer than it was before; thousands of computers that had been vulnerable to every hacker in the world were now vulnerable to only one: Max Vision.

- Max immediately jumped into a new, more socially acceptable project: He would write a Web application that would let anyone on the Internet request an automatic real-time scan of their network to assess whether or not they were open to the BIND attack. He also conceived a benign variant of the siege he’d just concluded. Like before, he would scan government and military networks. But instead of cracking the vulnerable computers, he’d automatically send an e-mail warning to the administrators. There’d be no need to hide behind a hacked dial-up account this time. Both services would live on his brand-new public website: Whitehats.com.

- After two days and nights of work, he was knee-deep in his new, legal hacking project when Beeson e-mailed again. “What happened? Thought you’d send me e-mail.”
- Max could hardly explain to his FBI friend that he’d been busy staging one of the largest government computer breaches in history. So he emphasized his new project instead. “I am almost finished creating a public service vulnerability scanner and patch site - but there are some parts that aren’t ready for release,” he wrote back.